(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();function F(){return window.go.main.App.GetDefaultGrammar()}function W(t){return window.go.main.App.GetTokens(t)}function j(t,e){return window.go.main.App.ParseStepByStep(t,e)}function Z(t,e){return window.go.main.App.ParseString(t,e)}function K(t){return window.go.main.App.ValidateGrammar(t)}let g=null,c=[],o=0,B=!1,L=null,w=500,m=null,p=null,h=null;const E=document.getElementById("grammarInput"),S=document.getElementById("inputString"),J=document.getElementById("parseBtn"),Q=document.getElementById("stepBtn"),X=document.getElementById("loadDefaultBtn"),T=document.getElementById("tokenDisplay"),i=document.getElementById("grammarStatus"),d=document.getElementById("treeContainer");document.getElementById("treeSvg");const k=document.getElementById("errorDisplay"),A=document.getElementById("stepControls"),Y=document.getElementById("stepCounter"),C=document.getElementById("stepDescription"),D=document.getElementById("prevStepBtn"),b=document.getElementById("nextStepBtn"),_=document.getElementById("playPauseBtn"),z=document.getElementById("playIcon"),M=document.getElementById("pauseIcon"),ee=document.getElementById("resetStepBtn"),G=document.getElementById("speedSlider"),te=document.getElementById("speedValue"),ne=document.getElementById("zoomInBtn"),re=document.getElementById("zoomOutBtn"),se=document.getElementById("resetZoomBtn"),ae=document.getElementById("helpBtn"),f=document.getElementById("helpModal");document.addEventListener("DOMContentLoaded",oe);function oe(){ie(),le(),O()}function ie(){J.addEventListener("click",me),Q.addEventListener("click",pe),X.addEventListener("click",O),S.addEventListener("input",de),E.addEventListener("input",ce),D.addEventListener("click",fe),b.addEventListener("click",ge),_.addEventListener("click",he),ee.addEventListener("click",ye),G.addEventListener("input",Be),ne.addEventListener("click",()=>N(1.3)),re.addEventListener("click",()=>N(.7)),se.addEventListener("click",Ee),ae.addEventListener("click",()=>f.classList.remove("hidden")),f.querySelector(".modal-backdrop").addEventListener("click",()=>f.classList.add("hidden")),f.querySelector(".modal-close").addEventListener("click",()=>f.classList.add("hidden"))}function le(){const t=d.clientWidth,e=d.clientHeight;m=d3.select("#treeSvg").attr("width",t).attr("height",e),h=d3.zoom().scaleExtent([.1,4]).on("zoom",r=>{p.attr("transform",r.transform)}),m.call(h),p=m.append("g").attr("transform",`translate(${t/2}, 50)`),window.addEventListener("resize",()=>{m.attr("width",d.clientWidth).attr("height",d.clientHeight)})}async function O(){try{const t=await F();E.value=t,$()}catch(t){console.error("Failed to load default grammar:",t)}}async function ce(){await $()}async function $(){const t=E.value.trim();if(!t){i.textContent="",i.className="status-message";return}try{const e=await K(t);e.valid?(i.textContent="\u2713 Grammar is valid",i.className="status-message success"):(i.textContent="\u2717 "+e.errors.join("; "),i.className="status-message error"),e.warnings&&e.warnings.length>0&&(i.textContent+=" \u26A0 "+e.warnings.join("; "),e.valid&&(i.className="status-message warning"))}catch(e){i.textContent="\u2717 "+e,i.className="status-message error"}}async function de(){const t=S.value.trim();if(!t){T.innerHTML="";return}try{const e=await W(t);ue(e)}catch(e){console.error("Failed to tokenize:",e)}}function ue(t){T.innerHTML=t.filter(e=>e.type!=="EOF").map(e=>{let r="token";return e.type==="NUMBER"?r+=" number":["PLUS","MINUS","MULT","DIV"].includes(e.type)?r+=" operator":["LPAREN","RPAREN"].includes(e.type)&&(r+=" paren"),`<span class="${r}">${e.value}</span>`}).join("")}async function me(){const t=E.value.trim(),e=S.value.trim();if(!t){u("Please enter a grammar");return}if(!e){u("Please enter an input string");return}U(),x();try{const r=await Z(t,e);r.success?(g=r.tree,V(g),q()):(u(r.error),y())}catch(r){u("Parse error: "+r),y()}}async function pe(){const t=E.value.trim(),e=S.value.trim();if(!t){u("Please enter a grammar");return}if(!e){u("Please enter an input string");return}U();try{const r=await j(t,e);r.success?(g=r.tree,c=r.steps,o=0,B=!1,Ie(),q(),y(),v()):(u(r.error),x())}catch(r){u("Parse error: "+r),x()}}function fe(){o>0&&(o--,P(),v())}function ge(){o<c.length&&(o++,P(),v())}function he(){B?I():R()}function R(){B=!0,z.classList.add("hidden"),M.classList.remove("hidden"),L=setInterval(()=>{o<c.length?(o++,P(),v()):I()},w)}function I(){B=!1,z.classList.remove("hidden"),M.classList.add("hidden"),L&&(clearInterval(L),L=null)}function ye(){I(),o=0,y(),v()}function Be(){w=parseInt(G.value),te.textContent=w+"ms",B&&(I(),R())}function v(){if(Y.textContent=`Step ${o} of ${c.length}`,o>0&&o<=c.length){const t=c[o-1];C.textContent=t.description}else C.textContent="Ready to start";D.disabled=o===0,b.disabled=o>=c.length}function P(){var r,l;if(o===0){y();return}const t=new Map,e=[];for(let s=0;s<o;s++){const n=c[s],a={id:n.nodeId,label:n.description.includes("terminal")?((r=n.description.match(/'([^']+)'/))==null?void 0:r[1])||"\u03B5":((l=n.description.match(/<([^>]+)>/))==null?void 0:l[1])||n.description,isTerminal:n.description.includes("terminal")||n.description.includes("epsilon"),children:[],isNew:s===o-1};t.set(n.nodeId,a),n.parentId===-1||n.parentId===0?e.push(a):t.has(n.parentId)?t.get(n.parentId).children.push(a):e.push(a)}if(e.length>0){const s=e[0];V(s,!0)}}function V(t,e=!1){if(!t)return;p.selectAll("*").remove();const r=d3.hierarchy(t,n=>n.children);d3.tree().nodeSize([80,100]).separation((n,a)=>n.parent===a.parent?1:1.5)(r),p.selectAll(".link").data(r.links()).enter().append("path").attr("class",n=>"link"+(e&&n.target.data.isNew?" new":"")).attr("d",d3.linkVertical().x(n=>n.x).y(n=>n.y));const s=p.selectAll(".node").data(r.descendants()).enter().append("g").attr("class","node").attr("transform",n=>`translate(${n.x}, ${n.y})`);s.append("circle").attr("r",25).attr("class",n=>{let a="";return n.data.isTerminal&&(a+="terminal "),e&&n.data.isNew&&(a+="new"),a.trim()}),s.append("text").attr("class",n=>n.data.isTerminal?"terminal":"").attr("dy","0.35em").text(n=>{const a=n.data.label||n.data.Label;return a&&a.length>8?a.substring(0,6)+"...":a}),H(r)}function H(t){if(!t)return;const e=p.node().getBBox(),r=d.clientWidth,l=d.clientHeight,s=Math.min((r-100)/e.width,(l-100)/e.height,1),n=r/2-(e.x+e.width/2)*s,a=50;m.transition().duration(300).call(h.transform,d3.zoomIdentity.translate(n,a).scale(s))}function y(){p.selectAll("*").remove()}function N(t){m.transition().duration(300).call(h.scaleBy,t)}function Ee(){if(g){const t=d3.hierarchy(g,e=>e.children);H(t)}else m.transition().duration(300).call(h.transform,d3.zoomIdentity.translate(d.clientWidth/2,50))}function u(t){k.textContent=t,k.classList.remove("hidden")}function U(){k.classList.add("hidden")}function Ie(){A.classList.remove("hidden")}function x(){A.classList.add("hidden"),I()}function q(){const t=d.querySelector(".empty-state");t&&(t.style.display="none")}
